<!DOCTYPE html>
<html  >
<head>
  <script>
      const estaLogueadoComprar = sessionStorage.getItem('usuarioLogueado');
      if (estaLogueadoComprar !== 'true') {
          alert('Debes iniciar sesión para acceder a esta página.');
          window.location.replace('registro.html');
      }
  </script>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-KQ2E5FLEEF"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-KQ2E5FLEEF');
  </script>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Mobirise v6.1.4, mobirise.com">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="shortcut icon" href="assets/images/logo2.png" type="image/x-icon">
  <meta name="description" content="">
  
  
  <title>Comprar</title>
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons2/mobirise2.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/animatecss/animate.css">
  <link rel="stylesheet" href="assets/dropdown/css/style.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Inter+Tight:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter+Tight:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap"></noscript>
  <link rel="preload" as="style" href="assets/mobirise/css/mbr-additional.css?v=YnpFkp"><link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css?v=YnpFkp" type="text/css">

</head>
<body>
  
  <section data-bs-version="5.1" class="menu menu4 cid-v0oeO1svCX" once="menu" id="menu04-29">
    <nav class="navbar navbar-dropdown navbar-fixed-top navbar-expand-lg">
        <div class="container">
            <div class="navbar-brand">
                <span class="navbar-logo">
                    <a href="index.html">
                        <img src="assets/images/logo2.png" alt="Mobirise Website Builder" style="height: 4rem;">
                    </a>
                </span>
            </div>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbarSupportedContent" data-bs-target="#navbarSupportedContent" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <div class="hamburger"><span></span><span></span><span></span><span></span></div>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav nav-dropdown" data-app-modern-menu="true"><li class="nav-item"><a class="nav-link link text-black text-primary display-4" href="index.html">Inicio</a></li><li class="nav-item"><a class="nav-link link text-black text-primary display-4" href="cartelera.html">Cartelera</a></li><li class="nav-item"><a class="nav-link link text-black show text-primary display-4" href="salas.html">Salas</a></li></ul>
                <div class="navbar-buttons mbr-section-btn"><a class="btn btn-primary display-4" href="registro.html">REGISTRATE!!</a></div>
            </div>
        </div>
    </nav>
</section>

<section data-bs-version="5.1" class="form5 cid-v0pEewa4l2" id="form02-2b" style="padding-top: 10rem; padding-bottom: 5rem;">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 content-head">
                <div class="mbr-section-head mb-5">
                    <h3 class="mbr-section-title mbr-fonts-style align-center mb-0 display-2"><strong>Finalizar Compra</strong></h3>
                </div>
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="row">
                    <div class="col-lg-7 col-md-12">
                        <h4>Detalles de Facturación</h4>
                        <form id="checkout-form">
                            <div class="row">
                                <div class="col-md-6 form-group mb-3">
                                    <label for="nombre" class="form-label">Nombre</label>
                                    <input type="text" name="nombre" placeholder="Tu Nombre" class="form-control" required>
                                </div>
                                <div class="col-md-6 form-group mb-3">
                                    <label for="apellido" class="form-label">Apellido</label>
                                    <input type="text" name="apellido" placeholder="Tu Apellido" class="form-control" required>
                                </div>
                            </div>
                            <div class="form-group mb-3">
                                <label for="email" class="form-label">Email</label>
                                <input type="email" name="email" placeholder="tu@email.com" class="form-control" required>
                            </div>
                            <div class="form-group mb-3">
                                <label for="domicilio" class="form-label">Domicilio</label>
                                <input type="text" name="domicilio" placeholder="Calle Falsa 123" class="form-control" required>
                            </div>
                            <div class="row">
                                <div class="col-md-6 form-group mb-3">
                                    <label for="ciudad" class="form-label">Ciudad</label>
                                    <input type="text" name="ciudad" placeholder="Tu Ciudad" class="form-control" required>
                                </div>
                                <div class="col-md-6 form-group mb-3">
                                    <label for="cp" class="form-label">Código Postal</label>
                                    <input type="text" name="cp" placeholder="4600" class="form-control" required>
                                </div>
                            </div>
                            <hr class="my-4">
                            <h4>Datos de Pago</h4>
                            <div class="form-group mb-3">
                                <label for="tarjeta-nombre" class="form-label">Nombre en la Tarjeta</label>
                                <input type="text" name="tarjeta-nombre" placeholder="Nombre como figura en la tarjeta" class="form-control" required>
                            </div>
                            <div class="form-group mb-3">
                                <label for="tarjeta-numero" class="form-label">Número de Tarjeta</label>
                                <input type="text" name="tarjeta-numero" placeholder="0000 0000 0000 0000" class="form-control" required>
                            </div>
                            <div class="row">
                                <div class="col-md-6 form-group mb-3">
                                    <label for="tarjeta-venc" class="form-label">Vencimiento (MM/AA)</label>
                                    <input type="text" name="tarjeta-venc" placeholder="MM/AA" class="form-control" required>
                                </div>
                                <div class="col-md-6 form-group mb-3">
                                    <label for="tarjeta-cvc" class="form-label">CVC</label>
                                    <input type="text" name="tarjeta-cvc" placeholder="123" class="form-control" required>
                                </div>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12 align-center mbr-section-btn mt-4">
                                <button type="submit" class="btn btn-primary display-7">Pagar Ahora</button>
                            </div>
                        </form>
                    </div>
                    <div class="col-lg-4 col-md-12 offset-lg-1">
                        <h4>Tu Carrito</h4>
                        <div class="card">
                            <div class="card-body" id="resumen-carrito">
                                <p>Cargando tu carrito...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<section data-bs-version="5.1" class="footer2 cid-v0oXCDlaOz" once="footers" id="footer02-2a">
    <div class="container">
        <div class="row">
            <div class="col-12 col-lg-6 center mt-2 mb-3">
                <p class="mbr-fonts-style copyright mb-0 display-7">© Copyright 2030 Mobirise - All Rights Reserved</p>
            </div>
            <div class="col-12 col-lg-6 center">
                <div class="row-links mt-2 mb-3">
                    <ul class="row-links-soc">
                    <li class="row-links-soc-item mbr-fonts-style display-7"><a href="#" class="text-primary">Instagram</a></li>
                    <li class="row-links-soc-item mbr-fonts-style display-7"><a href="#" class="text-primary">TikTok</a></li>
                    <li class="row-links-soc-item mbr-fonts-style display-7"><a href="#" class="text-primary">YouTube</a></li>
                    <li class="row-links-soc-item mbr-fonts-style display-7"><a href="#" class="text-primary">Twitter</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    let precioUnitario = 0;
    let itemSeleccionado = null;
    let cantidadSeleccionada = 1;

    window.onload = function() {
        const itemJSON = localStorage.getItem('carritoItem');
        const carritoDiv = document.getElementById('resumen-carrito');
        
        if (itemJSON) {
            itemSeleccionado = JSON.parse(itemJSON);
            precioUnitario = itemSeleccionado.precioUnitario;
            
            carritoDiv.innerHTML = `
                <img src="${itemSeleccionado.imagen}" class="img-fluid rounded mb-3" alt="${itemSeleccionado.nombre}">
                <h5 class="card-title">${itemSeleccionado.nombre}</h5>
                <p class="card-text mb-1">Sala: ${itemSeleccionado.sala}</p>
                <p class="card-text mb-2">Precio: $${precioUnitario.toFixed(2)}</p>
                <div class="form-group mb-3">
                    <label for="cantidad" class="form-label">Cantidad:</label>
                    <input type="number" class="form-control" id="cantidad" value="1" min="1" max="10">
                </div>
                <hr>
                <h6 class="card-subtitle mb-2 text-muted">Total</h6>
                <h4 id="precio-total">$${precioUnitario.toFixed(2)}</h4>
            `;
            document.getElementById('cantidad').addEventListener('input', actualizarTotal);
        } else {
            carritoDiv.innerHTML = '<p>Tu carrito está vacío.</p><a href="cartelera.html" class="btn btn-sm btn-secondary">Volver a la cartelera</a>';
             if (document.getElementById('checkout-form')) {
                document.getElementById('checkout-form').style.display = 'none';
            }
        }
    };

    function actualizarTotal() {
        cantidadSeleccionada = parseInt(document.getElementById('cantidad').value) || 1;
        const total = precioUnitario * cantidadSeleccionada;
        document.getElementById('precio-total').textContent = `$${total.toFixed(2)}`;
    }

    document.getElementById('checkout-form').addEventListener('submit', function(event) {
        event.preventDefault(); 
        
        const nombre = document.querySelector('input[name="nombre"]').value;
        const email = document.querySelector('input[name="email"]').value;
        const total = precioUnitario * cantidadSeleccionada;
        
        gtag('event', 'purchase', {
          'transaction_id': 'T' + Date.now(),
          'value': total,
          'currency': 'ARS',
          'items': [{
            'item_id': itemSeleccionado.nombre.replace(/\s+/g, '_').toLowerCase(),
            'item_name': itemSeleccionado.nombre,
            'price': precioUnitario,
            'quantity': cantidadSeleccionada
          }]
        });

        const compraConfirmada = {
            nombreCliente: nombre,
            emailCliente: email,
            obra: itemSeleccionado.nombre,
            sala: itemSeleccionado.sala,
            cantidad: cantidadSeleccionada,
            totalPagado: total
        };
        localStorage.setItem('compraConfirmada', JSON.stringify(compraConfirmada));
        window.location.href = 'confirmacion.html';
    });
</script>


<section class="display-7" style="padding: 0;align-items: center;justify-content: center;flex-wrap: wrap; align-content: center;display: flex;position: relative;height: 4rem;">
    <a href="https://mobiri.se/" style="flex: 1 1;height: 4rem;position: absolute;width: 100%;z-index: 1;"><img alt="" style="height: 4rem;" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="></a><p style="margin: 0;text-align: center;" class="display-7">&#8204;</p><a style="z-index:1" href="https://mobirise.com/builder/ai-website-generator.html">AI Website Generator</a>
</section>
<script src="assets/bootstrap/js/bootstrap.bundle.min.js"></script>  <script src="assets/smoothscroll/smooth-scroll.js"></script>  <script src="assets/ytplayer/index.js"></script>  <script src="assets/dropdown/js/navbar-dropdown.js"></script>  <script src="assets/theme/js/script.js"></script>  

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const usuario = sessionStorage.getItem('usuarioLogueado');
        const navButtonContainer = document.querySelector('.navbar-buttons');

        if (usuario === 'true') {
            navButtonContainer.innerHTML = `
                <a class="btn btn-primary display-4" href="#" id="logout-btn">CERRAR SESIÓN</a>
            `;
            const logoutBtn = document.getElementById('logout-btn');
            if(logoutBtn) {
                 logoutBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    sessionStorage.removeItem('usuarioLogueado');
                    sessionStorage.removeItem('usuarioEmail');
                    alert('Sesión cerrada.');
                    window.location.href = 'index.html';
                });
            }
        } else {
            navButtonContainer.innerHTML = '<a class="btn btn-primary display-4" href="registro.html">REGISTRATE!!</a>';
        }
    });
</script>
 
 <input name="animation" type="hidden">
  </body>
</html>